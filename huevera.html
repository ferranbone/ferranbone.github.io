<!doctype html>
<html>
<head>
    <nav>
        <details>
            <summary>Indice</summary>
            <ul>
                <li><a href="cv.html">Curriculum</a></li>
                <li><a href="aficiones.html">Aficiones</a></li>
                <li><a href="juego.html">Juego</a></li>
                <li><a href="contacto.html">Contactame</a></li>
                <li><a href="portada.html">Portada</a></li>
            </ul>
        </details>
    </nav>
    <meta charset="UTF-8" />
    <title>Hueveras de cart√≥n 2</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.60.0/phaser.min.js"></script>
    <script>
        let canvas_w = 800;
        let canvas_h = 450;
        let gameOver = false;
        let tiempoRestante = 60;
        let timerText;

        let config = {
            type: Phaser.AUTO,
            width: canvas_w,
            height: canvas_h,
            scene: {
                preload: precarga,
                create: crea,
                update: actualiza
            }
        };

        let game = new Phaser.Game(config);

        function precarga() {
            this.load.image('fondo', 'fondo.png');
            this.load.audio('musica_fondo', 'musica_fondo.mp3');
            this.load.audio('musica_gameover', 'musica_gameover.mp3');
        }

        function crea() {
            this.add.image(canvas_w / 2, canvas_h / 2, 'fondo').setDisplaySize(canvas_w, canvas_h);
            musicaFondo = this.sound.add('musica_fondo', { loop: true, volume: 0.5 });
            musicaGameOver = this.sound.add('musica_gameover', { loop: false, volume: 0.8 });
            musicaFondo.play();

            timerText = this.add.text(20, 20, `Tiempo: ${tiempoRestante}`, { fontSize: '32px', fill: '#fff' });

            this.time.addEvent({
                delay: 1000,
                callback: () => {
                    if (!gameOver) {
                        tiempoRestante--;
                        timerText.setText(`Tiempo: ${tiempoRestante}`);
                        if (tiempoRestante <= 0) {
                            darGameOver(this);
                        }
                    }
                },
                callbackScope: this,
                loop: true
            });
        }

        function darGameOver(scene) {
            gameOver = true;
            musicaFondo.stop();
            musicaGameOver.play();
            scene.add.text(canvas_w / 2, canvas_h / 2, 'GAME OVER', { fontSize: '64px', fill: '#ff0000' }).setOrigin(0.5);
        }

        function actualiza() {
        }
    </script>
</head>
<body>
</body>
</html>
